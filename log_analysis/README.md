Домашнее задание: Анализ лога веб-сервера

Цель: потренироваться писать парсеры для логов.
Задание

Написать скрипт анализа приложенного access.log файла.

Формат записи в файле лога: %h %t "%r" %>s %b "%{Referer}i" "%{User-Agent}i" %D

    %h - имя удаленного хоста
    %t - время получения запроса
    %r - тип запроса, его содержимое и версия
    %s - код состояния HTTP
    %b - количество отданных сервером байт
    %{Referer} - URL-источник запроса
    %{User-Agent} - HTTP-заголовок, содержащий информацию о запросе
    %D - длительность запроса в миллисекундах

Требования к реализации

    Должна быть возможность указать директорий где искать логи или конкретный файл
    Должна быть возможность обработки всех логов внутри одного директория (статистика по каждому логу должна выводиться отдельно и должна быть сохранена в отдельном json-файле)
    Для access.log должна собираться следующая информация:
        общее количество выполненных запросов
        количество запросов по HTTP-методам: GET - 20, POST - 10 и т.п. (список необходимых методов можно посмотреть в RFC: https://datatracker.ietf.org/doc/html/rfc7231#section-4)
        топ 3 IP адресов, с которых были сделаны запросы
        топ 3 самых долгих запросов, должно быть видно метод, url, ip, длительность, дату и время запроса
    Собранная статистика должна быть сохранена в json файл и выведена в терминал в свободном (но понятном) формате

Скрипт "Анализ лога веб-сервера"
Скрипт анализа приложенного access.log файла, возможности:

    Возможно указать директорий, где искать логи или конкретный файл (через аргумент командной строки -l)
    Вся статистика сохраняется в отдельном json-файле и выводится в терминал в удобном формате
    Обработка всех логов внутри одного директория
    Для access.log собирается следующая информация:
        общее количество выполненных запросов (total_requests)
        количество запросов по HTTP-методам (total_stat)
        топ 3 IP адресcов, с которых были сделаны запросы (top3_ip_requests)
        топ 3 самых долгих запросов c полямии: метод, url, ip, длительность, дату и время запроса (top3_slowly_requests)
    Пример запуска скрипта python log_parser.py -l access.log